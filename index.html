<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Byeage Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="åšå®¢">
<meta property="og:type" content="website">
<meta property="og:title" content="Byeage Blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Byeage Blog">
<meta property="og:description" content="åšå®¢">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Byeage Blog">
<meta name="twitter:description" content="åšå®¢">
  
    <link rel="alternate" href="/atom.xml" title="Byeage Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Byeage Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">ç™½ç—´æ€»å¾—åŠ æŠŠåŠ²</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="æœç´¢"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-test-e2e" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/05/22/test-e2e/" class="article-date">
  <time datetime="2017-05-22T09:55:00.000Z" itemprop="datePublished">2017-05-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/22/test-e2e/">test-e2e</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="ä»€ä¹ˆæ˜¯nightwatchï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯nightwatchï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯nightwatchï¼Ÿ"></a>ä»€ä¹ˆæ˜¯nightwatchï¼Ÿ</h3><p><a href="http://nightwatchjs.org/api#expect-negation" target="_blank" rel="external">nightwatch</a> æ˜¯ä¸€ä¸ªç”¨nodejs å†™çš„ç”¨äºç½‘ç«™å’Œç½‘é¡µåº”ç”¨çš„è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶ã€‚ç®€åŒ–å¯æŒç»­é›†æˆçš„è®¾ç½®å’Œæµ‹è¯•çš„ç¼–å†™ï¼Œä¹Ÿå¯ä»¥ç”¨äºnodejsçš„å•å…ƒæµ‹è¯•</p>
<p>è®¾ç½®é…ç½®å¯çœ‹å®˜æ–¹æ–‡æ¡£ï¼Œæœ‰ç‚¹å¤æ‚ğŸ˜…ï¼Œè¿™é‡Œä¸»è¦è®²è®²å¦‚ä½•åœ¨Vue-cli æ„å»ºçš„é¡¹ç›®é‡Œä½¿ç”¨nightwatch è¿›è¡Œend-to-endæµ‹è¯•</p>
<p>åœ¨test/e2e/specs/ æ–‡ä»¶ä¸‹æœ‰ä¸€ä¸ªé»˜è®¤çš„æµ‹è¯•æ–‡ä»¶çš„ä¾‹å­ test.jsï¼Œ nightwatch.conf.js å’Œ runner.js éƒ½ä¸ºé…ç½®æ–‡ä»¶ï¼Œcustom-assertions é‡Œé¢ä¸ºè‡ªå®šä¹‰æ–­è¨€ï¼Œreports ä¸ºæµ‹è¯•æŠ¥å‘Š</p>
<p>é¦–å…ˆå¾—å…ˆåœè¿è¿è¡Œä½ çš„npm run dev  ctrl + c ã€‚ ä¸ç„¶è¿è¡Œä¸‹ä½ çš„ npm run e2eæ—¶å€™å°±å—å±äº†ï¼Œè¿™çœ‹ä¸‹ä»–çš„é…ç½®å¤§æ¦‚å°±èƒ½ç†è§£äº†</p>
<pre><code>module.exports = {
    &apos;default e2e tests&apos;: function (browser) {  // æµ‹è¯•æè¿°
        // automatically uses dev Server port from /config.index.js // ç”¨äºæµ‹è¯•çš„æœåŠ¡å™¨
        // default: http://localhost:8080 //  é»˜è®¤æµ‹è¯•ç«¯å£
        // see nightwatch.conf.js  // nightwatch çš„é…ç½®æ–‡ä»¶

        const devServer = browser.globals.devServerURL  // æµ‹è¯•åœ°å€

        browser
        .url(devServer)    // A
        .waitForElementVisible(&apos;#app&apos;, 5000) //B  
        .assert.elementPresent(&apos;.hello&apos;) // C
        .assert.containsText(&apos;h1&apos;, &apos;Welcome to Your Vue.js App&apos;) // D
        .assert.elementCount(&apos;img&apos;, 1) // E
        .end() // F
    }
}
</code></pre><ul>
<li>A æµè§ˆå™¨åŠ è½½ç›®æ ‡åœ°å€</li>
<li>B åœ¨æ–­è¨€ä¹‹å‰ç­‰å¾…5000è®©é¡µé¢ä¸­#appçš„å…ƒç´ å¯è§ ï¼Œå¦‚æœåœ¨è®¾ç½®å¯¹æ—¶é—´å†…ï¼Œå…ƒç´ æœªå‡ºç°ï¼Œæµ‹è¯•å¤±è´¥</li>
<li>C é¡µé¢æœ‰å­˜åœ¨ .hello å…ƒç´ </li>
<li>D h1 æ ‡ç­¾é‡ŒåŒ…å«æ–‡æœ¬ â€˜Welcome to Your Vue.js Appâ€™</li>
<li>E é¡µé¢äº†æœ‰imgå…ƒç´ 1ä¸ª</li>
<li>F ç»“æŸ</li>
</ul>
<h3 id="åœ¨ä»‹ç»ä¸€ä¸ªå®˜æ–¹çš„ä¾‹å­ï¼Œä¸Šé¢ç”¨çš„æ˜¯è°·æ­Œçš„ä¾‹å­ï¼Œéœ€è¦ç¿»å¢™æˆ‘è¿™è¾¹ç¨å¾®ä¿®æ”¹ä¸‹ä½¿ç”¨ç™¾åº¦åšä¾‹å­-baidu-js"><a href="#åœ¨ä»‹ç»ä¸€ä¸ªå®˜æ–¹çš„ä¾‹å­ï¼Œä¸Šé¢ç”¨çš„æ˜¯è°·æ­Œçš„ä¾‹å­ï¼Œéœ€è¦ç¿»å¢™æˆ‘è¿™è¾¹ç¨å¾®ä¿®æ”¹ä¸‹ä½¿ç”¨ç™¾åº¦åšä¾‹å­-baidu-js" class="headerlink" title="åœ¨ä»‹ç»ä¸€ä¸ªå®˜æ–¹çš„ä¾‹å­ï¼Œä¸Šé¢ç”¨çš„æ˜¯è°·æ­Œçš„ä¾‹å­ï¼Œéœ€è¦ç¿»å¢™æˆ‘è¿™è¾¹ç¨å¾®ä¿®æ”¹ä¸‹ä½¿ç”¨ç™¾åº¦åšä¾‹å­ baidu.js"></a>åœ¨ä»‹ç»ä¸€ä¸ªå®˜æ–¹çš„ä¾‹å­ï¼Œä¸Šé¢ç”¨çš„æ˜¯è°·æ­Œçš„ä¾‹å­ï¼Œéœ€è¦ç¿»å¢™æˆ‘è¿™è¾¹ç¨å¾®ä¿®æ”¹ä¸‹ä½¿ç”¨ç™¾åº¦åšä¾‹å­ baidu.js</h3><pre><code>module.exports = {
    &apos;Demo test Baidu&apos;: function (browser) {
        browser
        .url(&apos;https://www.baidu.com/&apos;)
        .waitForElementVisible(&apos;body&apos;, 1000)
        .setValue(&apos;input#kw&apos;, &apos;é‚ªé©¬å°&apos;)  // A
        .waitForElementVisible(&apos;input#su&apos;, 1000) // B
        .click(&apos;input#su&apos;) // C
        .pause(1000) // D
        .assert.containsText(&apos;#container&apos;, &apos;é‚ªé©¬å°_ç™¾åº¦ç™¾ç§‘&apos;) // E
        .end()
    }
}
</code></pre><p>ä¸Šé¢è®²è¿‡çš„å°±ä¸é‡å¤äº† </p>
<ul>
<li>A ç­‰å¾…bodyé¡µé¢åŠ è½½ï¼Œè®¾ç½®ç™¾åº¦æœç´¢æ¡†çš„å€¼ä¸ºâ€˜é‚ªé©¬å°â€™</li>
<li>B ç­‰å¾…ç™¾åº¦æœç´¢æäº¤æŒ‰é’®å‡ºç°ï¼ˆè¿™ä¸ªå…¶å®é»˜è®¤å°±æœ‰ï¼Œæ²¿ç€è°·æ­Œçš„ä¾‹å­æ²¡å»æ‰ï¼‰</li>
<li>C è§¦å‘é¼ æ ‡å•å‡»äº‹ä»¶ï¼Œæ¨¡æ‹Ÿæœç´¢</li>
<li>D ç­‰å¾…1ç§’</li>
<li>E æ–­è¨€#container å…ƒç´ é‡Œæ–‡æœ¬åŒ…å« â€˜é‚ªé©¬å°_ç™¾åº¦ç™¾ç§‘â€™</li>
</ul>
<h3 id="åˆ†æ­¥æµ‹è¯•-muiltiple-step-js"><a href="#åˆ†æ­¥æµ‹è¯•-muiltiple-step-js" class="headerlink" title="åˆ†æ­¥æµ‹è¯• muiltiple-step.js"></a>åˆ†æ­¥æµ‹è¯• muiltiple-step.js</h3><p>module.exports = {<br>        â€˜Step oneâ€™: function (browser) {<br>            browser<br>            .url(â€˜<a href="https://www.baidu.com/" target="_blank" rel="external">https://www.baidu.com/</a>â€˜)<br>            .waitForElementVisible(â€˜bodyâ€™, 1000)<br>            .setValue(â€˜input#kwâ€™, â€˜é‚ªé©¬å°â€™)<br>            .waitForElementVisible(â€˜input#suâ€™, 1000)<br>            .click(â€˜input#suâ€™)<br>            .pause(1000)<br>        },<br>        â€˜Step twoâ€™: function(browser) {<br>            browser<br>            .assert.containsText(â€˜#containerâ€™, â€˜é‚ªé©¬å°_ç™¾åº¦ç™¾ç§‘â€™)<br>            .end()<br>        }<br>    }</p>
<p>è¿™ä¸ªå°±å¾ˆå¥½ç†è§£äº†ï¼Œä¸åšè¿‡å¤šè§£é‡Š</p>
<h3 id="ä½¿ç”¨é€‰æ‹©å™¨-selectors-js"><a href="#ä½¿ç”¨é€‰æ‹©å™¨-selectors-js" class="headerlink" title="ä½¿ç”¨é€‰æ‹©å™¨ selectors.js"></a>ä½¿ç”¨é€‰æ‹©å™¨ selectors.js</h3><pre><code>module.exports = {
    &apos;selector Test&apos;: function (browser) {
        const devServer = browser.globals.devServerURL + &apos;/index&apos;
        browser
        .url(devServer)
        .waitForElementVisible(&apos;#app&apos;, 5000)
        .useXpath() // A
        .assert.containsText(&apos;//*[@id=&quot;app&quot;]/div[1]/h1[2]&apos;, &apos;Test example&apos;)
        .useCss() // B
        .assert.containsText(&apos;.test-example&apos;, &apos;Test example&apos;)
        .end()
    }
}
</code></pre><ul>
<li>A ä½¿ç”¨xpath é€‰æ‹©å™¨ è°·æ­ŒF12 åœ¨Elementé‡Œé€‰æ‹©å…ƒç´ å³é”®copy é€‰æ‹© copy Xpath å…·ä½“è§„åˆ™è‡ªå·±ç™¾åº¦</li>
<li>B ä½¿ç”¨Css é€‰æ‹©å™¨</li>
</ul>
<h3 id="BBT-è¡Œä¸ºé©±åŠ¨å¼€å‘æµ‹è¯•-å…¶å®æ˜¯ä¸€ç§æ–­è¨€çš„æ–¹å¼ï¼Œæå¤§æé«˜äº†æ–­è¨€çš„å¯è¯»æ€§å’Œä¼˜é›…æ€§ğŸ˜‚-ã€‚å…·ä½“è¯­æ³•å‚ç…§-chai"><a href="#BBT-è¡Œä¸ºé©±åŠ¨å¼€å‘æµ‹è¯•-å…¶å®æ˜¯ä¸€ç§æ–­è¨€çš„æ–¹å¼ï¼Œæå¤§æé«˜äº†æ–­è¨€çš„å¯è¯»æ€§å’Œä¼˜é›…æ€§ğŸ˜‚-ã€‚å…·ä½“è¯­æ³•å‚ç…§-chai" class="headerlink" title="BBT è¡Œä¸ºé©±åŠ¨å¼€å‘æµ‹è¯•  å…¶å®æ˜¯ä¸€ç§æ–­è¨€çš„æ–¹å¼ï¼Œæå¤§æé«˜äº†æ–­è¨€çš„å¯è¯»æ€§å’Œä¼˜é›…æ€§ğŸ˜‚ ã€‚å…·ä½“è¯­æ³•å‚ç…§ chai"></a>BBT è¡Œä¸ºé©±åŠ¨å¼€å‘æµ‹è¯•  å…¶å®æ˜¯ä¸€ç§æ–­è¨€çš„æ–¹å¼ï¼Œæå¤§æé«˜äº†æ–­è¨€çš„å¯è¯»æ€§å’Œä¼˜é›…æ€§ğŸ˜‚ ã€‚å…·ä½“è¯­æ³•å‚ç…§ <a href="http://chaijs.com/api/" target="_blank" rel="external">chai</a></h3><pre><code>module.exports = {
    &apos;BBD-style Test&apos;: function (browser) {
        const devServer = browser.globals.devServerURL + &apos;/index&apos;

        browser
        .url(devServer)
        .waitForElementVisible(&apos;#app&apos;, 5000)
        browser.expect.element(&apos;.test-hello&apos;).to.be.present
        browser.expect.element(&apos;.test-hello&apos;).text.to.equal(&apos;Welcome to Your Vue.js App&apos;)
        browser.expect.element(&apos;.test-hello&apos;).text.to.contain(&apos;Welcome&apos;)
        browser.expect.element(&apos;.test-hello&apos;).to.be.an(&apos;h1&apos;)
        browser.expect.element(&apos;.test-hello&apos;).to.be.visible
        browser.end()
    }
}
</code></pre><p>æœ‰ä¸ªç¼ºç‚¹æ˜¯expect ä¸èƒ½ç”¨é“¾å¼çš„æ–¹å¼äº›ï¼Œæ¯ä¸ªæ–­è¨€å¿…é¡»å•ç‹¬ä½¿ç”¨ï¼Œexpect ç›¸å¯¹äº asserts ä½¿ç”¨</p>
<h3 id="æµ‹è¯•ä¸­çš„é’©å­"><a href="#æµ‹è¯•ä¸­çš„é’©å­" class="headerlink" title="æµ‹è¯•ä¸­çš„é’©å­"></a>æµ‹è¯•ä¸­çš„é’©å­</h3><pre><code>module.exports = {
    before: function(browser) {
        console.log(&apos;Setting up...&apos;);// A
    },
    after: function(browser) {
        console.log(&apos;Closing down...&apos;); // B
    },

    beforeEach: function(browser) { // C
        const devServer = browser.globals.devServerURL
        browser
        .url(devServer)
        .waitForElementVisible(&apos;#app&apos;, 3000)
    },

    afterEach: function(browser, done) { // D
        console.log(&apos;each end&apos;)
        done()
    },

    &apos;hook Test .test-example&apos;: function (browser) {
        browser
        .assert.containsText(&apos;.test-example&apos;, &apos;Test example&apos;)
        .end()
    },
    &apos;hook Test .test-hello&apos;: function (browser) {
        browser
        .assert.containsText(&apos;.test-hello&apos;, &apos;Welcome to Your Vue.js App&apos;)
        .end()
    }
};
</code></pre><ul>
<li>A åœ¨æ•´ä¸ªæµ‹è¯•è¿è¡Œä¹‹å‰è¿è¡Œä¸€æ¬¡</li>
<li>B åœ¨æ•´ä¸ªæµ‹è¯•å®Œæˆä¹‹åè¿è¡Œä¸€æ¬¡</li>
<li>C åœ¨æ¯ä¸€ä¸ªå°æµ‹è¯•è¿è¡Œä¹‹å‰è¿è¡Œä¸€æ¬¡</li>
<li>D åœ¨æ¯ä¸€æ¬¡å°æµ‹è¯•è¿è¡Œå®Œä¹‹åè¿è¡Œä¸€æ¬¡</li>
</ul>
<h3 id="ç°åœ¨æ‹¿ä¸€ä¸ªè‡ªå·±å†™çš„Vueçš„ä¾‹å­-index-js"><a href="#ç°åœ¨æ‹¿ä¸€ä¸ªè‡ªå·±å†™çš„Vueçš„ä¾‹å­-index-js" class="headerlink" title="ç°åœ¨æ‹¿ä¸€ä¸ªè‡ªå·±å†™çš„Vueçš„ä¾‹å­ index.js"></a>ç°åœ¨æ‹¿ä¸€ä¸ªè‡ªå·±å†™çš„Vueçš„ä¾‹å­ index.js</h3><pre><code>module.exports = {
    &apos;Index e2e tests&apos;: function (browser) {
        const devServer = browser.globals.devServerURL + &apos;#/index&apos; // éœ€è¦æµ‹è¯•çš„åœ°å€
        browser
        .url(devServer)
        .waitForElementVisible(&apos;#app&apos;, 5000)
        .assert.elementPresent(&apos;.show&apos;) // é»˜è®¤æ˜¾ç¤ºæ˜¯å­˜åœ¨çš„
        .click(&apos;.switch&apos;) // click ä¹‹å show ä¸ºfalse
        .assert.elementNotPresent(&apos;.show&apos;) // å…ƒç´ ä¸å­˜åœ¨äº†
        .end()
    }
}
</code></pre><h3 id="å¾…ç»­â€¦â€¦"><a href="#å¾…ç»­â€¦â€¦" class="headerlink" title="å¾…ç»­â€¦â€¦"></a>å¾…ç»­â€¦â€¦</h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/05/22/test-e2e/" data-id="cj2zypnr50008t6fy4bgdlhou" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-test-unit" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/05/19/test-unit/" class="article-date">
  <time datetime="2017-05-19T02:58:01.000Z" itemprop="datePublished">2017-05-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/19/test-unit/">test unit</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ul>
<li>æµ‹è¯•å¯ä»¥åˆ†æˆå‡ ç±»ï¼Œå•å…ƒæµ‹è¯•ï¼Œé›†æˆæµ‹è¯•</li>
<li>TDDï¼ˆæµ‹è¯•é©±åŠ¨å¼€å‘ï¼‰ç›´ç™½çš„è¯´å°±æ˜¯å…ˆå†™æµ‹è¯•ç”¨ä¾‹ï¼Œå†å†™ä»£ç ï¼Œç›´åˆ°æµ‹è¯•é€šè¿‡</li>
</ul>
<p>ä»£ç ä¸å‡ºé”™ä¸€èˆ¬æ˜¯ä¸æ­£å¸¸çš„ï¼ˆå…±è¯†ï¼‰ã€‚æµ‹è¯•ä¸€èˆ¬æŒ‡æ˜¯è‡ªåŠ¨æµ‹è¯•çš„ç®€ç§°ï¼Œè¿è¡Œæµ‹è¯•ä»£ç æ¥éªŒè¯è‡ªå·±å†™çš„ä»£ç </p>
<p>è¿›è¡Œä»£ç æµ‹è¯•çš„å¥½å¤„</p>
<ul>
<li>å¢å¼ºå¯¹è‡ªå·±ä»£ç çš„ä¿¡ä»»åº¦ï¼Œï¼ˆä¸ºå¥½æ‰¾å€Ÿå£æ¨è„±è´£ä»»å¢å¼ºè‡ªä¿¡å¿ƒï¼‰ ğŸ˜€</li>
<li>å½“ä½ ä¿®æ”¹ã€é‡æ„ä»£ç æ—¶ï¼Œä¸éœ€è¦äººå·¥å†å»éªŒè¯é‡æ„å®Œåçš„ä»£ç æœ‰æ²¡æœ‰é—®é¢˜</li>
<li>éªŒè¯ä½ çš„ä»£ç æ˜¯æ­£å¸¸å¯è¡Œçš„</li>
</ul>
<h3 id="Test-driven-development-TDD"><a href="#Test-driven-development-TDD" class="headerlink" title="Test-driven development TDD"></a>Test-driven development TDD</h3><p>TDD æµ‹è¯•çš„ä¸‰ä¸ªæµç¨‹<br><img src="/2017/05/19/test-unit/tdd.png" alt="TDD"></p>
<ol>
<li>red Step åœ¨ä½ å†™çœŸå®çš„ä»£ç ä¹‹å‰ï¼Œå…ˆå†™æµ‹è¯•ç”¨ä¾‹çš„ä»£ç ã€‚å½“ç„¶å†™å®Œä¹‹åçš„æµ‹è¯•ç”¨ä¾‹éƒ½æ˜¯é€šä¸è¿‡çš„</li>
<li>green step åœ¨å®Œæµ‹è¯•ç”¨ä¾‹ä¹‹åå¼€å§‹å†™ä½ è‡ªå·±çœŸå®çš„ä»£ç ï¼Œè¿‡ç¨‹ä¸­ï¼Œæµ‹è¯•ç”¨ä¾‹ä¼šä¸€ä¸ªä¸ªçš„é€šè¿‡ï¼Œç”±red çŠ¶æ€è½¬æˆ red çŠ¶æ€ï¼Œä¸€æ—¦é€šè¿‡æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹ï¼Œå°±è·³è½¬åˆ°äº†step 3</li>
<li>refactor step é‡æ„ä¼˜åŒ–é˜¶æ®µï¼Œ å¯ä»¥æ”¾çºµçš„é‡æ„ï¼Œåæ­£ç”±æµ‹è¯•ä»£ç å¸®ä½ éªŒè¯é€šè¿‡ä¸å¦</li>
<li>repeat process  æ·»åŠ æ–°çš„æµ‹è¯•ç”¨ä¾‹ï¼Œé‡å¤ä¸Šè¿°æ­¥éª¤</li>
</ol>
<p>å¸¸ç”¨æµ‹è¯•å·¥å…· <strong><em>Mocha</em></strong> <strong><em>chai</em></strong> <strong><em>supertest</em></strong> <strong><em>cheerio</em></strong></p>
<p><img src="/2017/05/19/test-unit/structure.png" alt="structure"></p>
<h3 id="capitalize-js"><a href="#capitalize-js" class="headerlink" title="capitalize.js"></a>capitalize.js</h3><pre><code>function capitalize(str) {
    var firstLetter = str.charAt(0).toUpperCase();
    var rest = str.slice(1).toLowerCase();
    return firstLetter + rest
}

module.exports = capitalize;
</code></pre><hr>
<h3 id="test-capitalize-js"><a href="#test-capitalize-js" class="headerlink" title="/test/capitalize.js"></a>/test/capitalize.js</h3><pre><code>var capitialize = require(&apos;../capitalize&apos;);
var chai = require(&quot;chai&quot;);
var expect = chai.expect;

describe(&quot;capitalize&quot;, function() {
    it(&quot;capitializes single words&quot;, function() {
        expect(capitialize(&quot;express&quot;)).to.equal(&quot;Express&quot;);
        expect(capitialize(&quot;cats&quot;)).to.equal(&quot;Cats&quot;);
    })

    it(&quot;makes the rest of the string lowercase&quot;, function(){
        expect(capitialize(&quot;javaScript&quot;)).to.equal(&quot;Javascript&quot;);
    })
    it(&quot;leaves empty strings alone&quot;, function () {
        expect(capitialize(&quot;&quot;)).to.equal(&quot;&quot;);
    })
    it(&quot;throws an error if passed a number&quot;, function() {
        expect(function() {
            capitialize(123)
        }).to.throw(Error)
    })
    // åå‘æµ‹è¯•
    it(&quot;changes the value&quot;, function() {
        expect(capitialize(&quot;foo&quot;)).not.to.equal(&quot;foo&quot;);
    })
})
</code></pre><hr>
<h3 id="user-js"><a href="#user-js" class="headerlink" title="user.js"></a>user.js</h3><pre><code>function User(params) {
    this.firstName = params.firstName || &apos;&apos;;
    this.lastName = params.lastName || &apos;&apos;;
    this.birthDay = params.birthday || &apos;&apos;;
}

User.prototype.getName = function() {
    return this.firstName + &apos; &apos; + this.lastName
}
User.prototype.getAge = function() {
    return new Date() - this.birthDay;
}


module.exports = User;
</code></pre><hr>
<h3 id="test-user-js"><a href="#test-user-js" class="headerlink" title="/test/user.js"></a>/test/user.js</h3><pre><code>var User = require(&quot;../user&quot;);
var chai = require(&quot;chai&quot;)
var expect = chai.expect;


describe(&quot;User&quot;, function(){

// åœ¨æµ‹è¯•ä¹‹å‰å…ˆæ‰§è¡Œä¸€æ®µä»£ç 
var user;
beforeEach(function() {
    user = new User({
        firstName: &quot;Douglas&quot;,
        lastName: &quot;Reynholm&quot;,
        birthDay: new Date(1975,10,2)
    })
});

it(&quot;can extract its name&quot;, function() {
    expect(user.getName()).to.equal(&quot;Douglas Reynholm&quot;)
})
    it(&quot;can get its&apos;s age in milliseconds&quot;, function() {
    var now = new Date();
    expect(user.getAge()).to.equal(now - user.birthDay);
    });
});
</code></pre><hr>
<h3 id="test-txt-js"><a href="#test-txt-js" class="headerlink" title="/test/txt.js"></a>/test/txt.js</h3><pre><code>var app = require(&quot;../app&quot;)
var supertest = require(&quot;supertest&quot;);

describe(&quot;plain text response&quot;, function() {
    var request;

    beforeEach(function() {
        request = supertest(app)
            .get(&quot;/&quot;)
            .set(&quot;User-Agent&quot;, &quot;my cool browser&quot;)
            .set(&quot;Accept&quot;, &quot;text/plain&quot;)
    })

    it(&quot;plain text response&quot;, function(done) {
        request
            .expect(&quot;Content-type&quot;,/text\/plain/)
            .expect(200)
            .end(done)
    });

    it(&quot;returns your User Agent&quot;, function(done) {
        request
            .expect(function(res) {
                if(res.text!== &quot;my cool browser&quot;) {
                    throw new Error(&quot;Response does not container User Agent&quot;)
                }
            })
            .end(done)
    });
})
</code></pre><hr>
<h3 id="html-js"><a href="#html-js" class="headerlink" title="html.js"></a>html.js</h3><pre><code>var app = require(&quot;../app&quot;);
var supertest = require(&quot;supertest&quot;);
var cheerio = require(&quot;cheerio&quot;);

describe(&quot;html response&quot;, function() {
var request;
beforeEach(function() {
    request = supertest(app)
        .get(&quot;/&quot;)
        .set(&quot;User-Agent&quot;, &quot;a cool browser&quot;)
        .set(&quot;Accept&quot;, &quot;text/html&quot;)
});

it(&quot;returns an HTML&quot;, function(done) {
        request
            .expect(&quot;Content-Type&quot;, /html/)
            .expect(200)
            .end(done)
});

    it(&quot;returns your User Agent&quot;, function(done) {
        request
            .expect(function(res) {
                var htmlResponse = res.text;
                var $ = cheerio.load(htmlResponse);
                var userAgent = $(&quot;.user-agent&quot;).html().trim();
                if(userAgent !== &apos;a cool browser&apos;) {
                    throw new Error(&quot;User Agent not found&quot;);
                }
            })
            .end(done)
    });
});
</code></pre><hr>
<h3 id="app-js"><a href="#app-js" class="headerlink" title="app.js"></a>app.js</h3><pre><code>var express = require(&quot;express&quot;);
var app = express()
var path = require(&quot;path&quot;)

app.set(&quot;port&quot;, process.env.PORT || 3000)

app.set(&quot;view engine&quot;, &quot;ejs&quot;);
var viewPath = path.resolve(__dirname,&quot;views&quot;);
app.set(&quot;views&quot;, viewPath)


app.get(&quot;/&quot;, function(req, res) {
    var userAgent = req.headers[&quot;user-agent&quot;] || &apos;none&apos;;
    if(req.accepts(&quot;html&quot;)) {
        res.render(&quot;index&quot;, {userAgent: userAgent});
    } else {
        res.type(&quot;text&quot;)
        res.send(req.headers[&quot;user-agent&quot;]);
    }
});

app.listen(app.get(&quot;port&quot;),function(){
    console.log(&quot;App started on port &quot; + app.get(&quot;port&quot;));
})

module.exports = app
</code></pre><hr>
<h3 id="view-index-ejs"><a href="#view-index-ejs" class="headerlink" title="view/index.ejs"></a>view/index.ejs</h3><pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;style&gt;
        html {
            font-family: sans-serif;
            text-align: center;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h2&gt;Your User Agent is:&lt;/h2&gt;
&lt;h1 class=&quot;user-agent&quot;&gt;
    &lt;%= userAgent %&gt;
&lt;/h1&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/05/19/test-unit/" data-id="cj2zypnr70009t6fy90ctbcbz" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-passport" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/05/18/passport/" class="article-date">
  <time datetime="2017-05-18T14:21:54.000Z" itemprop="datePublished">2017-05-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/18/passport/">passport</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="passport-ä¸­é—´ä»¶"><a href="#passport-ä¸­é—´ä»¶" class="headerlink" title="passport ä¸­é—´ä»¶"></a>passport ä¸­é—´ä»¶</h3><p>Authenticating requests is as simple as calling passport.authenticate() and specifying which strategy to employ. </p>
<p>standard Connect middleware</p>
<p>By default, if authentication fails, Passport will respond with a 401 Unauthorized status, and any additional route handlers will not be invoked. If authentication succeeds, the next handler will be invoked and the req.user property will be set to the authenticated user.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/05/18/passport/" data-id="cj2zypnrb000at6fysysr2or1" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-express-mongodb" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/05/18/express-mongodb/" class="article-date">
  <time datetime="2017-05-18T03:27:08.000Z" itemprop="datePublished">2017-05-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/18/express-mongodb/">express+mongodb</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>express ç¨‹åºå’Œ mongodb çš„ç»“æ„<br><img src="/2017/05/18/express-mongodb/structure.png" alt="structure"></p>
<h3 id="mongo-é…ç½®æ–‡ä»¶-mongod-conf"><a href="#mongo-é…ç½®æ–‡ä»¶-mongod-conf" class="headerlink" title="mongo é…ç½®æ–‡ä»¶ mongod.conf"></a>mongo é…ç½®æ–‡ä»¶ mongod.conf</h3><pre><code>systemLog:
    destination: file
    path: &quot;/var/log/mongodb/mongod.log&quot;
    logAppend: true
storage:
    dbPath: &quot;/data/db&quot;
net:
    bindIp: 127.0.0.1
    port: 27017
</code></pre><h3 id="å¯åŠ¨mongo"><a href="#å¯åŠ¨mongo" class="headerlink" title="å¯åŠ¨mongo"></a>å¯åŠ¨mongo</h3><p>mongod â€“config /etc/mongod.conf        </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/05/18/express-mongodb/" data-id="cj2zypnqq0004t6fykvqrhf14" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-express-è§†å›¾" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/05/18/express-è§†å›¾/" class="article-date">
  <time datetime="2017-05-18T03:02:49.000Z" itemprop="datePublished">2017-05-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/18/express-è§†å›¾/">express è§†å›¾</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Expresæ—¶-è§†å›¾é€‰æ‹©ä¸Šè¿˜æ˜¯é€‰æ‹©PUGæ¯”è¾ƒå¥½ï¼Œè¯­æ³•ç®€ä»‹ï¼Œæœ‰layoutï¼ŒmixinsåŠŸèƒ½"><a href="#Expresæ—¶-è§†å›¾é€‰æ‹©ä¸Šè¿˜æ˜¯é€‰æ‹©PUGæ¯”è¾ƒå¥½ï¼Œè¯­æ³•ç®€ä»‹ï¼Œæœ‰layoutï¼ŒmixinsåŠŸèƒ½" class="headerlink" title="Expresæ—¶ è§†å›¾é€‰æ‹©ä¸Šè¿˜æ˜¯é€‰æ‹©PUGæ¯”è¾ƒå¥½ï¼Œè¯­æ³•ç®€ä»‹ï¼Œæœ‰layoutï¼ŒmixinsåŠŸèƒ½"></a>Expresæ—¶ è§†å›¾é€‰æ‹©ä¸Šè¿˜æ˜¯é€‰æ‹©PUGæ¯”è¾ƒå¥½ï¼Œè¯­æ³•ç®€ä»‹ï¼Œæœ‰layoutï¼ŒmixinsåŠŸèƒ½</h3><p>express æ¯æ¬¡renderçš„æ—¶å€™éƒ½ä¼šåˆ›å»ºæ–°çš„å¯¹è±¡äº¤ç»™è§†å›¾å¼•æ“æ¸²æŸ“ï¼Œexpress å¯ä»¥è®¾ç½®è§†å›¾çš„ç¼“å­˜ï¼Œè€Œä¸ç”¨æ¯æ¬¡éƒ½é‡æ–°æ¸²æŸ“</p>
<pre><code>app.enabled(&quot;view cache&quot;)
app.disable(&quot;view cache&quot;)
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/05/18/express-è§†å›¾/" data-id="cj2zypnqx0006t6fy8gmjez8w" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Http-çŠ¶æ€ç " class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/05/18/Http-çŠ¶æ€ç /" class="article-date">
  <time datetime="2017-05-18T01:58:41.000Z" itemprop="datePublished">2017-05-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/18/Http-çŠ¶æ€ç /">Http çŠ¶æ€ç </a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>HTTP çŠ¶æ€è¯ é‡Šï¼Œæœ‰ç‚¹æ„æ€<br>1xx: hold on<br>2xx: here you go<br>3xx: go away<br>4xx: you messed up<br>5xx: I messed up</p>
<table>
<thead>
<tr>
<th>çŠ¶æ€ç </th>
<th>description</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>100</td>
<td>Continue</td>
<td>ç»§ç»­ã€‚å®¢æˆ·ç«¯åº”ç»§ç»­å…¶è¯·æ±‚</td>
</tr>
<tr>
<td>101</td>
<td>Switching Protocols</td>
<td>åˆ‡æ¢åè®®ã€‚æœåŠ¡å™¨æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚åˆ‡æ¢åè®®ã€‚åªèƒ½åˆ‡æ¢åˆ°æ›´é«˜çº§çš„åè®®ï¼Œä¾‹å¦‚ï¼Œåˆ‡æ¢åˆ°HTTPçš„æ–°ç‰ˆæœ¬åè®®</td>
</tr>
<tr>
<td>200</td>
<td>OK</td>
<td>è¯·æ±‚æˆåŠŸã€‚ä¸€èˆ¬ç”¨äºGETä¸POSTè¯·æ±‚</td>
</tr>
<tr>
<td>201</td>
<td>Created</td>
<td>å·²åˆ›å»ºã€‚æˆåŠŸè¯·æ±‚å¹¶åˆ›å»ºäº†æ–°çš„èµ„æº</td>
</tr>
<tr>
<td>202</td>
<td>Accepted</td>
<td>å·²æ¥å—ã€‚å·²ç»æ¥å—è¯·æ±‚ï¼Œä½†æœªå¤„ç†å®Œæˆ</td>
</tr>
<tr>
<td>203</td>
<td>Non-Authoritative Information</td>
<td>éæˆæƒä¿¡æ¯ã€‚è¯·æ±‚æˆåŠŸã€‚ä½†è¿”å›çš„metaä¿¡æ¯ä¸åœ¨åŸå§‹çš„æœåŠ¡å™¨ï¼Œè€Œæ˜¯ä¸€ä¸ªå‰¯æœ¬</td>
</tr>
<tr>
<td>204</td>
<td>No Content</td>
<td>æ— å†…å®¹ã€‚æœåŠ¡å™¨æˆåŠŸå¤„ç†ï¼Œä½†æœªè¿”å›å†…å®¹ã€‚åœ¨æœªæ›´æ–°ç½‘é¡µçš„æƒ…å†µä¸‹ï¼Œå¯ç¡®ä¿æµè§ˆå™¨ç»§ç»­æ˜¾ç¤ºå½“å‰æ–‡æ¡£</td>
</tr>
<tr>
<td>205</td>
<td>Reset Content</td>
<td>é‡ç½®å†…å®¹ã€‚æœåŠ¡å™¨å¤„ç†æˆåŠŸï¼Œç”¨æˆ·ç»ˆç«¯ï¼ˆä¾‹å¦‚ï¼šæµè§ˆå™¨ï¼‰åº”é‡ç½®æ–‡æ¡£è§†å›¾ã€‚å¯é€šè¿‡æ­¤è¿”å›ç æ¸…é™¤æµè§ˆå™¨çš„è¡¨å•åŸŸ</td>
</tr>
<tr>
<td>206</td>
<td>Partial Content</td>
<td>éƒ¨åˆ†å†…å®¹ã€‚æœåŠ¡å™¨æˆåŠŸå¤„ç†äº†éƒ¨åˆ†GETè¯·æ±‚</td>
</tr>
<tr>
<td>300</td>
<td>Multiple Choices</td>
<td>å¤šç§é€‰æ‹©ã€‚è¯·æ±‚çš„èµ„æºå¯åŒ…æ‹¬å¤šä¸ªä½ç½®ï¼Œç›¸åº”å¯è¿”å›ä¸€ä¸ªèµ„æºç‰¹å¾ä¸åœ°å€çš„åˆ—è¡¨ç”¨äºç”¨æˆ·ç»ˆç«¯ï¼ˆä¾‹å¦‚ï¼šæµè§ˆå™¨ï¼‰é€‰æ‹©</td>
</tr>
<tr>
<td>301</td>
<td>Moved Permanently</td>
<td>æ°¸ä¹…ç§»åŠ¨ã€‚è¯·æ±‚çš„èµ„æºå·²è¢«æ°¸ä¹…çš„ç§»åŠ¨åˆ°æ–°URIï¼Œè¿”å›ä¿¡æ¯ä¼šåŒ…æ‹¬æ–°çš„URIï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å®šå‘åˆ°æ–°URIã€‚ä»Šåä»»ä½•æ–°çš„è¯·æ±‚éƒ½åº”ä½¿ç”¨æ–°çš„URIä»£æ›¿</td>
</tr>
<tr>
<td>302</td>
<td>Found</td>
<td>ä¸´æ—¶ç§»åŠ¨ã€‚ä¸301ç±»ä¼¼ã€‚ä½†èµ„æºåªæ˜¯ä¸´æ—¶è¢«ç§»åŠ¨ã€‚å®¢æˆ·ç«¯åº”ç»§ç»­ä½¿ç”¨åŸæœ‰URI</td>
</tr>
<tr>
<td>303</td>
<td>See Other</td>
<td>æŸ¥çœ‹å…¶å®ƒåœ°å€ã€‚ä¸301ç±»ä¼¼ã€‚ä½¿ç”¨GETå’ŒPOSTè¯·æ±‚æŸ¥çœ‹</td>
</tr>
<tr>
<td>304</td>
<td>Not Modified</td>
<td>æœªä¿®æ”¹ã€‚æ‰€è¯·æ±‚çš„èµ„æºæœªä¿®æ”¹ï¼ŒæœåŠ¡å™¨è¿”å›æ­¤çŠ¶æ€ç æ—¶ï¼Œä¸ä¼šè¿”å›ä»»ä½•èµ„æºã€‚å®¢æˆ·ç«¯é€šå¸¸ä¼šç¼“å­˜è®¿é—®è¿‡çš„èµ„æºï¼Œé€šè¿‡æä¾›ä¸€ä¸ªå¤´ä¿¡æ¯æŒ‡å‡ºå®¢æˆ·ç«¯å¸Œæœ›åªè¿”å›åœ¨æŒ‡å®šæ—¥æœŸä¹‹åä¿®æ”¹çš„èµ„æº</td>
</tr>
<tr>
<td>305</td>
<td>Use Proxy</td>
<td>ä½¿ç”¨ä»£ç†ã€‚æ‰€è¯·æ±‚çš„èµ„æºå¿…é¡»é€šè¿‡ä»£ç†è®¿é—®</td>
</tr>
<tr>
<td>306</td>
<td>Unused</td>
<td>å·²ç»è¢«åºŸå¼ƒçš„HTTPçŠ¶æ€ç </td>
</tr>
<tr>
<td>307</td>
<td>Temporary Redirect</td>
<td>ä¸´æ—¶é‡å®šå‘ã€‚ä¸302ç±»ä¼¼ã€‚ä½¿ç”¨GETè¯·æ±‚é‡å®šå‘</td>
</tr>
<tr>
<td>400</td>
<td>Bad Request</td>
<td>å®¢æˆ·ç«¯è¯·æ±‚çš„è¯­æ³•é”™è¯¯ï¼ŒæœåŠ¡å™¨æ— æ³•ç†è§£</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized</td>
<td>è¯·æ±‚è¦æ±‚ç”¨æˆ·çš„èº«ä»½è®¤è¯</td>
</tr>
<tr>
<td>402</td>
<td>Payment Required</td>
<td>ä¿ç•™ï¼Œå°†æ¥ä½¿ç”¨</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden</td>
<td>æœåŠ¡å™¨ç†è§£è¯·æ±‚å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æ‰§è¡Œæ­¤è¯·æ±‚</td>
</tr>
<tr>
<td>404</td>
<td>Not Found</td>
<td>æœåŠ¡å™¨æ— æ³•æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚æ‰¾åˆ°èµ„æºï¼ˆç½‘é¡µï¼‰ã€‚é€šè¿‡æ­¤ä»£ç ï¼Œç½‘ç«™è®¾è®¡äººå‘˜å¯è®¾ç½®â€æ‚¨æ‰€è¯·æ±‚çš„èµ„æºæ— æ³•æ‰¾åˆ°â€çš„ä¸ªæ€§é¡µé¢</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed</td>
<td>å®¢æˆ·ç«¯è¯·æ±‚ä¸­çš„æ–¹æ³•è¢«ç¦æ­¢</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable</td>
<td>æœåŠ¡å™¨æ— æ³•æ ¹æ®å®¢æˆ·ç«¯è¯·æ±‚çš„å†…å®¹ç‰¹æ€§å®Œæˆè¯·æ±‚</td>
</tr>
<tr>
<td>407</td>
<td>Proxy Authentication Required</td>
<td>è¯·æ±‚è¦æ±‚ä»£ç†çš„èº«ä»½è®¤è¯ï¼Œä¸401ç±»ä¼¼ï¼Œä½†è¯·æ±‚è€…åº”å½“ä½¿ç”¨ä»£ç†è¿›è¡Œæˆæƒ</td>
</tr>
<tr>
<td>408</td>
<td>Request Time-out</td>
<td>æœåŠ¡å™¨ç­‰å¾…å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚æ—¶é—´è¿‡é•¿ï¼Œè¶…æ—¶</td>
</tr>
<tr>
<td>409</td>
<td>Conflict</td>
<td>æœåŠ¡å™¨å®Œæˆå®¢æˆ·ç«¯çš„PUTè¯·æ±‚æ˜¯å¯èƒ½è¿”å›æ­¤ä»£ç ï¼ŒæœåŠ¡å™¨å¤„ç†è¯·æ±‚æ—¶å‘ç”Ÿäº†å†²çª</td>
</tr>
<tr>
<td>410</td>
<td>Gone</td>
<td>å®¢æˆ·ç«¯è¯·æ±‚çš„èµ„æºå·²ç»ä¸å­˜åœ¨ã€‚410ä¸åŒäº404ï¼Œå¦‚æœèµ„æºä»¥å‰æœ‰ç°åœ¨è¢«æ°¸ä¹…åˆ é™¤äº†å¯ä½¿ç”¨410ä»£ç ï¼Œç½‘ç«™è®¾è®¡äººå‘˜å¯é€šè¿‡301ä»£ç æŒ‡å®šèµ„æºçš„æ–°ä½ç½®</td>
</tr>
<tr>
<td>411</td>
<td>Length Required</td>
<td>æœåŠ¡å™¨æ— æ³•å¤„ç†å®¢æˆ·ç«¯å‘é€çš„ä¸å¸¦Content-Lengthçš„è¯·æ±‚ä¿¡æ¯</td>
</tr>
<tr>
<td>412</td>
<td>Precondition Failed</td>
<td>å®¢æˆ·ç«¯è¯·æ±‚ä¿¡æ¯çš„å…ˆå†³æ¡ä»¶é”™è¯¯</td>
</tr>
<tr>
<td>413</td>
<td>Request Entity Too Large</td>
<td>ç”±äºè¯·æ±‚çš„å®ä½“è¿‡å¤§ï¼ŒæœåŠ¡å™¨æ— æ³•å¤„ç†ï¼Œå› æ­¤æ‹’ç»è¯·æ±‚ã€‚ä¸ºé˜²æ­¢å®¢æˆ·ç«¯çš„è¿ç»­è¯·æ±‚ï¼ŒæœåŠ¡å™¨å¯èƒ½ä¼šå…³é—­è¿æ¥ã€‚å¦‚æœåªæ˜¯æœåŠ¡å™¨æš‚æ—¶æ— æ³•å¤„ç†ï¼Œåˆ™ä¼šåŒ…å«ä¸€ä¸ªRetry-Afterçš„å“åº”ä¿¡æ¯</td>
</tr>
<tr>
<td>414</td>
<td>Request-URI Too Large</td>
<td>è¯·æ±‚çš„URIè¿‡é•¿ï¼ˆURIé€šå¸¸ä¸ºç½‘å€ï¼‰ï¼ŒæœåŠ¡å™¨æ— æ³•å¤„ç†</td>
</tr>
<tr>
<td>415</td>
<td>Unsupported Media Type</td>
<td>æœåŠ¡å™¨æ— æ³•å¤„ç†è¯·æ±‚é™„å¸¦çš„åª’ä½“æ ¼å¼</td>
</tr>
<tr>
<td>416</td>
<td>Requested range not satisfiable</td>
<td>å®¢æˆ·ç«¯è¯·æ±‚çš„èŒƒå›´æ— æ•ˆ</td>
</tr>
<tr>
<td>417</td>
<td>Expectation Failed</td>
<td>æœåŠ¡å™¨æ— æ³•æ»¡è¶³Expectçš„è¯·æ±‚å¤´ä¿¡æ¯</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error</td>
<td>æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œæ— æ³•å®Œæˆè¯·æ±‚</td>
</tr>
<tr>
<td>501</td>
<td>Not Implemented</td>
<td>æœåŠ¡å™¨ä¸æ”¯æŒè¯·æ±‚çš„åŠŸèƒ½ï¼Œæ— æ³•å®Œæˆè¯·æ±‚</td>
</tr>
<tr>
<td>502</td>
<td>Bad Gateway</td>
<td>å……å½“ç½‘å…³æˆ–ä»£ç†çš„æœåŠ¡å™¨ï¼Œä»è¿œç«¯æœåŠ¡å™¨æ¥æ”¶åˆ°äº†ä¸€ä¸ªæ— æ•ˆçš„è¯·æ±‚</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable</td>
<td>ç”±äºè¶…è½½æˆ–ç³»ç»Ÿç»´æŠ¤ï¼ŒæœåŠ¡å™¨æš‚æ—¶çš„æ— æ³•å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚å»¶æ—¶çš„é•¿åº¦å¯åŒ…å«åœ¨æœåŠ¡å™¨çš„Retry-Afterå¤´ä¿¡æ¯ä¸­</td>
</tr>
<tr>
<td>504</td>
<td>Gateway Time-out</td>
<td>å……å½“ç½‘å…³æˆ–ä»£ç†çš„æœåŠ¡å™¨ï¼ŒæœªåŠæ—¶ä»è¿œç«¯æœåŠ¡å™¨è·å–è¯·æ±‚</td>
</tr>
<tr>
<td>505</td>
<td>HTTP Version not supported</td>
<td>æœåŠ¡å™¨ä¸æ”¯æŒè¯·æ±‚çš„HTTPåè®®çš„ç‰ˆæœ¬ï¼Œæ— æ³•å®Œæˆå¤„ç†</td>
</tr>
</tbody>
</table>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/05/18/Http-çŠ¶æ€ç /" data-id="cj2zypnqf0001t6fyku6gnzdc" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-express-router" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/05/17/express-router/" class="article-date">
  <time datetime="2017-05-17T15:08:15.000Z" itemprop="datePublished">2017-05-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/17/express-router/">express-router</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Express-simple"><a href="#Express-simple" class="headerlink" title="Express simple"></a>Express simple</h3><pre><code>app.get(&quot;/users&quot;, function(request, response) {
response.send(&quot;Users&quot;);
});
</code></pre><h3 id="Express-router-å¸¦å‚æ•°"><a href="#Express-router-å¸¦å‚æ•°" class="headerlink" title="Express router å¸¦å‚æ•°"></a>Express router å¸¦å‚æ•°</h3><pre><code>app.get(&quot;/users/:userid&quot;, function(req, res) {
    var userId = parseInt(req.params.userid, 10);
    // ...
}
</code></pre><h3 id="Express-router-ç”¨æ­£åˆ™åŒ¹é…ï¼Œæ›´ç²¾ç»†çš„æ§åˆ¶è·¯ç”±"><a href="#Express-router-ç”¨æ­£åˆ™åŒ¹é…ï¼Œæ›´ç²¾ç»†çš„æ§åˆ¶è·¯ç”±" class="headerlink" title="Express router ç”¨æ­£åˆ™åŒ¹é…ï¼Œæ›´ç²¾ç»†çš„æ§åˆ¶è·¯ç”±"></a>Express router ç”¨æ­£åˆ™åŒ¹é…ï¼Œæ›´ç²¾ç»†çš„æ§åˆ¶è·¯ç”±</h3><pre><code>app.get(/^\/users\/(\d+)$/, function(req, res) {
    var userId = parseInt(req.params[0], 10);
    // ...
});
</code></pre><p><strong><em>users/</em></strong> åé¢å¸¦çš„å‚æ•°å¿…é¡»ä¸ºæ•°å­—</p>
<pre><code>app.get(/^\/users\/(\d+)-(\d+)$/, function(req, res) {
    var startId = parseInt(req.params[0], 10);
    var endId = parseInt(req.params[1], 10);
    // ...
});
</code></pre><p>åŒ¹é…è·¯ç”± <strong><em>/users/100-500</em></strong></p>
<h3 id="Express-router-è·å–æŸ¥è¯¢å‚æ•°"><a href="#Express-router-è·å–æŸ¥è¯¢å‚æ•°" class="headerlink" title="Express router  è·å–æŸ¥è¯¢å‚æ•°"></a>Express router  è·å–æŸ¥è¯¢å‚æ•°</h3><p><strong><em>ï¼search?keywords=nodejs</em></strong> é€šè¿‡req.query[â€˜keyâ€™] è·å–æŸ¥è¯¢å‚æ•°</p>
<pre><code>app.get(&quot;/search&quot;, function(req, res) {
   var keywords = req.query.keywords 
// ...
});
</code></pre><hr>
<h3 id="ä½¿ç”¨router-åˆ†å‰²åº”ç”¨"><a href="#ä½¿ç”¨router-åˆ†å‰²åº”ç”¨" class="headerlink" title="ä½¿ç”¨router åˆ†å‰²åº”ç”¨"></a>ä½¿ç”¨router åˆ†å‰²åº”ç”¨</h3><blockquote>
<p>A router is an isolated instance of middleware and routes. Routers can be<br>thought of as â€œminiâ€ applications only capable of performing middleware<br>and routing. Every express application has a built-in app router.</p>
</blockquote>
<p>Routers å¯ä»¥è¡¨ç°çš„åƒä¸­é—´ä»¶ï¼Œé€šè¿‡.use() ç»„åˆåˆ°åº”ç”¨ä¸­ã€‚ç®€è€Œè¨€ä¹‹ï¼Œrouter å°†åŸæœ¬åºå¤§çš„åº”ç”¨åˆ†å‰²æˆä¸€ä¸ªä¸ªminiåº”ç”¨ï¼Œ<br>ç„¶åä¸€ä¸ªä¸ªminiåº”ç”¨å¯ä»¥é€šè¿‡ç±»ä¼¼ä¸­é—´ä»¶çš„æ–¹å¼ï¼Œå°†å®ƒä»¬æ‹¼å‡‘èµ·æ¥ï¼Œç»„æˆä¸€ä¸ªå¤§å‹åº”ç”¨ã€‚å…¶å®router å°±æ˜¯ä¸€ä¸ªåŸºç¡€çš„middlewareã€‚</p>
<h4 id="å­è·¯ç”±"><a href="#å­è·¯ç”±" class="headerlink" title="å­è·¯ç”±"></a>å­è·¯ç”±</h4><pre><code>var express = require(&quot;express&quot;);
var api = express.Router();
api.use(function(req, res, next) {
    // doing something
    next();
});
api.get(&quot;/users&quot;, function(req, res) { /* ... */ });
api.post(&quot;/user&quot;, function(req, res) { /* ... */ });
module.exports = api;
</code></pre><p> è¿™çœ‹èµ·æ¥å°±åƒä¸€ä¸ªminiçš„åº”ç”¨ï¼Œä»–æ”¯æŒä¸­é—´ä»¶å’Œè·¯ç”±ï¼Œä½†ä»–ä¸èƒ½å•ç‹¬è¿è¡Œï¼Œåªèƒ½æ’å…¥åˆ°ä¸»åº”ç”¨å½“ä¸­å»ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ï¼Œå°±èƒ½å°†åº”ç”¨åˆ†å‰²æˆå„ä¸ªéƒ¨åˆ†äº†</p>
<hr>
<h3 id="express-static-ä¸­é—´ä»¶"><a href="#express-static-ä¸­é—´ä»¶" class="headerlink" title="express.static ä¸­é—´ä»¶"></a>express.static ä¸­é—´ä»¶</h3><pre><code>var publicPath = path.resolve(__dirname, &quot;public&quot;);
app.use(express.static(publicPath));
</code></pre><p>è®¾ç½®é™æ€æ–‡ä»¶å¤¹ï¼Œpath.resolve æ”¯æŒè·¨å¹³å°çš„è·¯å¾„è§£æã€‚é»˜è®¤é™æ€æ–‡ä»¶å¤¹è®¾ç½®åœ¨ç½‘ç«™çš„æ ¹ç›®å½•ï¼Œç„¶é¥¿ä½ ä¹Ÿå¯ä»¥æŒ‡å®šé™æ€æ–‡ä»¶å¤¹çš„ä½ç½®ã€‚å¹¸è¿çš„æ˜¯Expresä¸­é—´ä»¶å¯ä»¥æŒ‡å®šmountçš„ä½ç½®ï¼Œä»¥ä¸ºç€ä¸­é—´ä»¶åªåœ¨åˆ¶å®šçš„ä½ç½®åšå‡ºå“åº”ã€‚</p>
<blockquote>
<p>Note that this can be done for any middleware, not only the static file middleware.</p>
</blockquote>
<pre><code>var publicPath = path.resolve(__dirname, &quot;public&quot;);
app.use(&apos;/admin&apos;,express.static(publicPath));
</code></pre><p>ä½¿ç”¨å¤šä¸ªé™æ€æ–‡ä»¶å¤¹ ï¼Œbecause express.static is middleware, you can just apply it multiple times</p>
<pre><code>var publicPath = path.resolve(__dirname, &quot;public&quot;);
var userUploadsPath = path.resolve(__dirname, &quot;user_uploads&quot;);
app.use(express.static(publicPath));
app.use(express.static(userUploadsPath));
</code></pre><p> å› ä¸ºæŒ‡å®šäº†å¤šä¸ªé™æ€æ–‡ä»¶å¤¹ï¼Œè¯·æ±‚ä¼šåœ¨è¿™å¤šä¸ªæ–‡ä»¶å¤¹é‡Œå¯»æ‰¾åŒ¹é…çš„èµ„æºï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªä¹‹åå³ç»“æŸäº†å“åº”ï¼Œå¦‚æœå¤šä¸ªæ–‡ä»¶å¤¹é‡Œæœ‰é‡åçš„èµ„æºï¼Œå°±æœ‰å¯èƒ½è¿”å›é”™è¯¯çš„èµ„æºã€‚æ‰€ä»¥å½“æœ‰å¤šä¸ªé™æ€æ–‡ä»¶å¤¹æ—¶ï¼Œä¸€èˆ¬å¯ä»¥é€šè¿‡æŒ‡å®šè·¯å¾„çš„æ–¹å¼æ¥é¿å…å†²çªã€‚</p>
<pre><code>app.use(&quot;/public&quot;, express.static(publicPath));
app.use(&quot;/uploads&quot;, express.static(userUploadsPath));    
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/05/17/express-router/" data-id="cj2zypnqt0005t6fyk42pjzqh" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Express-å¸¸ç”¨ä¸­é—´ä»¶" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/05/17/Express-å¸¸ç”¨ä¸­é—´ä»¶/" class="article-date">
  <time datetime="2017-05-17T09:52:01.000Z" itemprop="datePublished">2017-05-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/17/Express-å¸¸ç”¨ä¸­é—´ä»¶/">Express å¸¸ç”¨ä¸­é—´ä»¶</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Express-å¸¸ç”¨ä¸­é—´ä»¶"><a href="#Express-å¸¸ç”¨ä¸­é—´ä»¶" class="headerlink" title="Express å¸¸ç”¨ä¸­é—´ä»¶"></a>Express å¸¸ç”¨ä¸­é—´ä»¶</h3><hr>
<ul>
<li>body-parser </li>
<li>cookie-parser</li>
<li>compression</li>
<li>Helmet</li>
<li>connect-assets</li>
<li>bcrypt-nodejs  ç”¨äºç”¨æˆ·å¯†ç ç­‰çš„åŠ å¯†</li>
<li>connect-flash</li>
<li>passport ç”¨äºç”¨æˆ·çš„éªŒè¯</li>
<li>passport-local éªŒè¯ç­–ç•¥</li>
<li>mongoose </li>
<li>pug</li>
<li>passport</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/05/17/Express-å¸¸ç”¨ä¸­é—´ä»¶/" data-id="cj2zypnq90000t6fyw2xhts5w" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-express-middleware" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/05/17/express-middleware/" class="article-date">
  <time datetime="2017-05-17T08:15:51.000Z" itemprop="datePublished">2017-05-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/17/express-middleware/">express middleware</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>å…³äºExpress ä¸­é—´ä»¶æ‰§è¡Œçš„ä¸€å¼ å¾ˆå¥½ç†è§£çš„å›¾<br><img src="/2017/05/17/express-middleware/node-middleware.png" alt="express-middleware"></p>
<ol>
<li>åœ¨resquest å’Œ response ä¹‹é—´å¤„ç†ä¸€äº›ä»»åŠ¡</li>
<li>middleware stack æ˜¯ä¸€ä¸ªå…ƒç´ ä¸ºå‡½æ•°çš„æ•°ç»„</li>
<li>åœ¨æ¯ä¸€ä¸ªmiddleware çš„ä¸­é—´ä»¶å‡½æ•°ä¸­éƒ½å¯ä»¥ä¿®æ”¹resquestå’Œresponse ï¼Œåœ¨ä¸­é—´ä»¶å‡½æ•°ä¸­éœ€è¦å¯¹request ä½œå‡ºå“åº”ï¼Œå¯ä»¥æ˜¯ç¬¬ä¸€ä¸ªä¹Ÿå¯ä»¥æ˜¯æœ€åä¸€ä¸ªï¼Œå¦‚æœæ²¡æœ‰å“åº”ï¼ŒæœåŠ¡å°±ä¼šæŒ‚èµ·</li>
<li>åˆ©ç”¨ä¸­é—´ä»¶å¯ä»¥å°†åº”ç”¨åˆ†å‰²æˆä¸€ä¸ªä¸ªç»„ä»¶ï¼Œä¾¿äºç®¡ç†ç»„åˆ</li>
<li>åœ¨express ä¸­ä½ å¯ä»¥ä½¿ç”¨app.use å°†ä¸­é—´ä»¶å‡½æ•°åº”ç”¨åˆ°middleware stack ä¸­</li>
<li>åœ¨middleware function ä¸­éœ€è¦å®Œæˆresquestçš„å“åº”æˆ–è€…å°†requestçš„å“åº”äº¤ç»™ä¸‹ä¸€ä¸ªmiddleware functionå¤„ç†ï¼Œç›´åˆ°å®Œæˆå¯¹resquestçš„å“åº”</li>
</ol>
<hr>
<h3 id="error-hanlder-middleware"><a href="#error-hanlder-middleware" class="headerlink" title="error-hanlder middleware"></a>error-hanlder middleware</h3><p>æœ‰ä¸¤ç§ä¸­é—´ä»¶<br> . è´Ÿè´£ä»»åŠ¡å¤„ç†<br> . è´Ÿè´£é”™è¯¯å¤„ç†<br> åœ¨ä¸­é—´ä»¶é‡Œæœªå‡ºç°é”™è¯¯ï¼Œåˆ™è·³è¿‡error-handler middlewareï¼Œç›´æ¥äº¤ç»™ä¸‹ä¸€ä¸ªmiddleware<br> <img src="/2017/05/17/express-middleware/error-handler-1.png" alt="error-handler"><br> åœ¨ä¸­é—´ä»¶é‡Œå‡ºç°é”™è¯¯ï¼Œåˆ™äº¤ç»™error-handler middlewareï¼Œ ç»“æŸå“åº”<br> <img src="/2017/05/17/express-middleware/error-handler-2.png" alt="error-handler"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/05/17/express-middleware/" data-id="cj2zypnqo0003t6fyxs436fjl" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Welcome" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/05/16/Welcome/" class="article-date">
  <time datetime="2017-05-16T06:47:21.000Z" itemprop="datePublished">2017-05-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/16/Welcome/">welcome</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Welcome-to-Lihuazhidaoâ€™s-Blog"><a href="#Welcome-to-Lihuazhidaoâ€™s-Blog" class="headerlink" title="Welcome to Lihuazhidaoâ€™s Blog"></a>Welcome to Lihuazhidaoâ€™s Blog</h1>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/05/16/Welcome/" data-id="cj2zypnql0002t6fyt33iqa4v" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">å½’æ¡£</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">äº”æœˆ 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">æœ€æ–°æ–‡ç« </h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/05/22/test-e2e/">test-e2e</a>
          </li>
        
          <li>
            <a href="/2017/05/19/test-unit/">test unit</a>
          </li>
        
          <li>
            <a href="/2017/05/18/passport/">passport</a>
          </li>
        
          <li>
            <a href="/2017/05/18/express-mongodb/">express+mongodb</a>
          </li>
        
          <li>
            <a href="/2017/05/18/express-è§†å›¾/">express è§†å›¾</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 madao<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>